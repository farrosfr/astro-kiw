---
import { Image } from 'astro:assets';
import { pool } from '../lib/db';

let topCategories: { kategori: string }[] = [];

try {
  const [rows] = await pool.query(`
    SELECT kategori, COUNT(*) as product_count
    FROM products
    GROUP BY kategori
    ORDER BY product_count DESC
    LIMIT 5
  `);
  topCategories = rows as { kategori: string }[];
} catch (error) {
  console.error('Error fetching top categories:', error);
}
---
<footer class="bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-gray-200 py-10">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 grid grid-cols-1 md:grid-cols-5 gap-8">
    <!-- Logo and About -->
    <div class="col-span-1 md:col-span-2">
      <Image src="/logo.png" alt="SonusHUB Logo" width={40} height={40} class="mb-4" loading="lazy" />
      <p class="text-sm">Platform B2B dan B2G untuk material listrik, solusi industri cerdas, dan teknologi energi terbarukan.</p>
    </div>

    <!-- Quick Links -->
    <div>
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Halaman</h3>
      <ul>
        <li class="mb-2"><a href="/" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">Beranda</a></li>
        <li class="mb-2"><a href="/katalog" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">Katalog</a></li>
        <li class="mb-2"><a href="/kategori" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">Kategori</a></li>
        <li class="mb-2"><a href="/merk" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">Merk</a></li>
        <li class="mb-2"><a href="/blog" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">Blog</a></li>
      </ul>
    </div>

    <!-- Top Categories -->
    <div>
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Top Kategori</h3>
      <ul>
        {topCategories.map(category => (
          <li class="mb-2">
            <a href={`/kategori/${category.kategori}`} class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">
              {category.kategori}
            </a>
          </li>
        ))}
      </ul>
    </div>

    <!-- Contact Info -->
    <div>
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Hubungi Kami</h3>
      <p class="text-sm mb-2">Gedung PDIN Lt. 2 Jl C. Simanjuntak 575 Kota Yogyakarta DI Yogyakarta</p>
      <p class="text-sm mb-2">Email: <a href="mailto:admin@solar-nusantara.id" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">admin@solar-nusantara.id</a></p>
      <p class="text-sm mb-2">Telpon/WA: <a href="tel:+6282180000575" class="hover:text-blue-600 dark:hover:text-white transition-colors duration-200">+62 821-8000-0575</a></p>
      <div class="flex space-x-4 mt-4">
        <a href="https://www.instagram.com/sonushub.id" class="text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200" aria-label="Instagram"><!-- Instagram Icon Placeholder -->
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-instagram"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.5" y1="6.5" y2="6.5"/></svg>
        </a>
        <a href="https://www.linkedin.com/showcase/sonushub" class="text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200" aria-label="LinkedIn"><!-- LinkedIn Icon Placeholder -->
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"/><rect width="4" height="12" x="2" y="9"/><circle cx="4" cy="4" r="2"/></svg>
        </a>
      </div>
    </div>
  </div>
  <div class="text-center text-gray-700 dark:text-gray-200 mt-8">
    <p>&copy; {new Date().getFullYear()} SonusHUB. All rights reserved.</p>
  </div>
</footer>